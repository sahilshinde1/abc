/*
E->TE'
E'->+TE'|-TE'|null
T->*FT'
T'->*FT'|/FT'|null
F->id|(E)|num
*/
#include<stdio.h>
#include<stdlib.h>
#include<string.h>
void E();
void T();
void Ed();
void Td();
void F();
void advance();
int pos=-1,l,st=-1;
char id,num;
char prod[100][100];
char input[100];
void advance()
{
	pos++;
	if(pos<l)
	{
		if(input[pos]>='0' && input[pos]<='9')
		{
			num=input[pos];
			id='\0';
		}
		if((input[pos]>='a'||input[pos]>='A')&&(input[pos]<='z'||input[pos]<='Z'))
		{
			num='\0';
			id=input[pos];
		}
	}
}
void E()
{
	strcpy(prod[++st],"E->TE'");
	printf("\nE->TE'");
	T();
	Ed();
}
void Ed()
{
	int p=1;
	if(input[pos]=='+')
	{
		p=0;
		strcpy(prod[++st],"E'->+TE'");
		printf("\nE'->+TE'");
		advance();
		T();
		Ed();
	}
	else if(input[pos]=='-')
	{
		p=0;
		strcpy(prod[++st],"E'->-TE'");
		printf("\nE'->-TE'");
		advance();
		T();
		Ed();
	}
	if(p==1)
	{
		strcpy(prod[++st],"E'->NULL");
		printf("\nE'->NULL");
		printf("\nbacktracked");
	}
}
void T()
{
	F();
	Td();
}
void Td()
{
	int p=1;
	if(input[pos]=='*')
	{
		p=0;
		strcpy(prod[++st],"T'->*FT'");
		printf("\nT'->*FT'");
		advance();
		F();
		Td();
	}
	else if(input[pos]=='/')
	{
		p=0;
		strcpy(prod[++st],"T'->*FT'");
		printf("\nT'->*FT'");
		advance();
		F();
		Td();
	}
	if(p==1)
	{
		strcpy(prod[++st],"T'->NULL");
		printf("\nT'->NULL");
		printf("\nbacktracked");
	}
}
void F()
{
	
	if(input[pos]==id)
	{
		strcpy(prod[++st],"F->id");
		printf("\nF->id");
		printf("\nbacktracked");
		advance();
	}
	else if(input[pos]=='(')
	{
		strcpy(prod[++st],"F->(E)");
		advance();
		E();
		if(input[pos]==')')
		{
			advance();
		}
		
	}
	if(input[pos]==num)
	{
		strcpy(prod[++st],"F->num");
		printf("\nF->num");
		printf("\nbacktracked");
		advance();
	}
}
int main()
{
	int i;
	printf("Enter input string:");
	scanf("%s",input);
	l=strlen(input);
	input[l]='$';
	advance();
	E();
	if(pos==l)
	{
		printf("String accepted\n");
	}
	else
	printf("String rejected\n");
	getch();
	return 0;
}